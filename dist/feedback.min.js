<<<<<<< HEAD
!function e(t,a,i){function s(o,d){if(!a[o]){if(!t[o]){var n="function"==typeof require&&require;if(!d&&n)return n(o,!0);if(c)return c(o,!0);throw new Error("Cannot find module '"+o+"'")}var r=a[o]={exports:{}};t[o][0].call(r.exports,function(e){var a=t[o][1][e];return s(a?a:e)},r,r.exports,e,t,a,i)}return a[o].exports}for(var c="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,a){!function(t){t.feedback=function(a){function i(){canDraw=!1,t(document).off("mouseenter mouseleave",".feedback-helper"),t(document).off("mouseup keyup"),t(document).off("mousedown",".feedback-setblackout"),t(document).off("mousedown",".feedback-sethighlight"),t(document).off("mousedown click","#feedback-close"),t(document).off("mousedown","#feedback-canvas"),t(document).off("click","#feedback-highlighter-next"),t(document).off("click","#feedback-highlighter-back"),t(document).off("click","#feedback-welcome-next"),t(document).off("click","#feedback-overview-back"),t(document).off("mouseleave","body"),t(document).off("mouseenter",".feedback-helper"),t(document).off("selectstart dragstart",document),t("#feedback-module").off("click",".feedback-wizard-close,.feedback-close-btn"),t(document).off("click","#feedback-submit"),o.highlightElement&&(t(document).off("click","#feedback-canvas"),t(document).off("mousemove","#feedback-canvas")),t('[data-highlighted="true"]').removeAttr("data-highlight-id").removeAttr("data-highlighted"),t("#feedback-module").remove(),t(".feedback-btn").show(),o.onClose.call(this)}function s(e,a){a="undefined"!=typeof a?a:!0,e.clearRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),e.fillStyle="rgba(102,102,102,0.5)",e.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&a&&c(e,parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&e.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"blackout"==t(this).attr("data-type")&&(e.fillStyle="rgba(0,0,0,1)",e.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()))})}function c(e,t,a,i,s){e.strokeStyle=o.strokeStyle,e.shadowColor=o.shadowColor,e.shadowOffsetX=o.shadowOffsetX,e.shadowOffsetY=o.shadowOffsetY,e.shadowBlur=o.shadowBlur,e.lineJoin=o.lineJoin,e.lineWidth=o.lineWidth,e.strokeRect(t,a,i,s),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.lineWidth=1}var o=t.extend({ajaxURL:"",postBrowserInfo:!0,postHTML:!0,postURL:!0,proxy:void 0,letterRendering:!1,initButtonText:"Send feedback",strokeStyle:"black",shadowColor:"black",shadowOffsetX:1,shadowOffsetY:1,shadowBlur:10,lineJoin:"bevel",lineWidth:3,html2canvasURL:"html2canvas.js",feedbackButton:".feedback-btn",showDescriptionModal:!0,isDraggable:!0,onScreenshotTaken:function(){},tpl:{description:e("../templates/description.html"),highlighter:e("../templates/highlighter.html"),overview:e("../templates/overview.html"),submitSuccess:e("../templates/submitSuccess.html"),submitError:e("../templates/submitError.html")},onClose:function(){},screenshotStroke:!0,highlightElement:!0,initialBox:!1},a),d=!!window.HTMLCanvasElement,n=".feedback-btn"==o.feedbackButton,r=!1;d&&(n&&t("body").append('<button class="feedback-btn feedback-btn-gray">'+o.initButtonText+"</button>"),t(document).on("click",o.feedbackButton,function(){n&&t(this).hide(),r||t.getScript(o.html2canvasURL,function(){r=!0});var e=!1,a="",d=t(document).height(),h=t(document).width(),l='<div id="feedback-module">';o.initialBox&&(l+=o.tpl.description),l+=o.tpl.highlighter+o.tpl.overview+'<canvas id="feedback-canvas"></canvas><div id="feedback-helpers"></div><input id="feedback-note" name="feedback-note" type="hidden"></div>',t("body").append(l),moduleStyle={position:"absolute",left:"0px",top:"0px"},canvasAttr={width:h,height:d},t("#feedback-module").css(moduleStyle),t("#feedback-canvas").attr(canvasAttr).css("z-index","30000"),o.initialBox||(t("#feedback-highlighter-back").remove(),e=!0,t("#feedback-canvas").css("cursor","crosshair"),t("#feedback-helpers").show(),t("#feedback-welcome").hide(),t("#feedback-highlighter").show()),o.isDraggable&&t("#feedback-highlighter").on("mousedown",function(e){var a=t(this).addClass("feedback-draggable"),i=a.outerHeight(),s=a.outerWidth(),c=a.offset().top+i-e.pageY,o=a.offset().left+s-e.pageX;a.css("z-index",4e4).parents().on("mousemove",function(e){_top=e.pageY+c-i,_left=e.pageX+o-s,_bottom=i-e.pageY,_right=s-e.pageX,_left<0&&(_left=0),_top<0&&(_top=0),_right>t(window).width()&&(_left=t(window).width()-s),_left>t(window).width()-s&&(_left=t(window).width()-s),_bottom>t(document).height()&&(_top=t(document).height()-i),_top>t(document).height()-i&&(_top=t(document).height()-i),t(".feedback-draggable").offset({top:_top,left:_left}).on("mouseup",function(){t(this).removeClass("feedback-draggable")})}),e.preventDefault()}).on("mouseup",function(){t(this).removeClass("feedback-draggable"),t(this).parents().off("mousemove mousedown")});var f=t("#feedback-canvas")[0].getContext("2d");if(f.fillStyle="rgba(102,102,102,0.5)",f.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),rect={},drag=!1,highlight=1,post={},o.postBrowserInfo&&(post.browser={},post.browser.appCodeName=navigator.appCodeName,post.browser.appName=navigator.appName,post.browser.appVersion=navigator.appVersion,post.browser.cookieEnabled=navigator.cookieEnabled,post.browser.onLine=navigator.onLine,post.browser.platform=navigator.platform,post.browser.userAgent=navigator.userAgent,post.browser.plugins=[],t.each(navigator.plugins,function(e){post.browser.plugins.push(navigator.plugins[e].name)}),t("#feedback-browser-info").show()),o.postURL&&(post.url=document.URL,t("#feedback-page-info").show()),o.postHTML&&(post.html=t("html").html(),t("#feedback-page-structure").show()),o.postBrowserInfo||o.postURL||o.postHTML||t("#feedback-additional-none").show(),t(document).on("mousedown","#feedback-canvas",function(a){e&&(rect.startX=a.pageX-t(this).offset().left,rect.startY=a.pageY-t(this).offset().top,rect.w=0,rect.h=0,drag=!0)}),t(document).on("mouseup",function(){if(e){drag=!1;var a=rect.startY,i=rect.startX,c=rect.w,o=rect.h;if(dtype="highlight",0==c||0==o)return;0>c&&(i+=c,c*=-1),0>o&&(a+=o,o*=-1),a+o>t(document).height()&&(o=t(document).height()-a),i+c>t(document).width()&&(c=t(document).width()-i),0==highlight&&(dtype="blackout"),t("#feedback-helpers").append('<div class="feedback-helper" data-type="'+dtype+'" data-time="'+Date.now()+'" style="position:absolute;top:'+a+"px;left:"+i+"px;width:"+c+"px;height:"+o+'px;z-index:30000;"></div>'),s(f),rect.w=0}}),t(document).on("mousemove",function(a){e&&drag&&(t("#feedback-highlighter").css("cursor","default"),rect.w=a.pageX-t("#feedback-canvas").offset().left-rect.startX,rect.h=a.pageY-t("#feedback-canvas").offset().top-rect.startY,f.clearRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),f.fillStyle="rgba(102,102,102,0.5)",f.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&c(f,parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),1==highlight&&(c(f,rect.startX,rect.startY,rect.w,rect.h),f.clearRect(rect.startX,rect.startY,rect.w,rect.h)),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"blackout"==t(this).attr("data-type")&&(f.fillStyle="rgba(0,0,0,1)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()))}),0==highlight&&(f.fillStyle="rgba(0,0,0,0.5)",f.fillRect(rect.startX,rect.startY,rect.w,rect.h)))}),o.highlightElement){var b=[],p=[],u=0;t(document).on("mousemove click","#feedback-canvas",function(a){if(e){s(f),p=[],t("#feedback-canvas").css("cursor","crosshair"),t("* :not(body,script,iframe,div,section,.feedback-btn,#feedback-module *)").each(function(){"true"!==t(this).attr("data-highlighted")&&a.pageX>t(this).offset().left&&a.pageX<t(this).offset().left+t(this).width()&&a.pageY>t(this).offset().top+parseInt(t(this).css("padding-top"),10)&&a.pageY<t(this).offset().top+t(this).height()+parseInt(t(this).css("padding-top"),10)&&p.push(t(this))});var i=p[p.length-1];if(i&&!drag){t("#feedback-canvas").css("cursor","pointer");var o=i.offset().left-2,d=i.offset().top-2,n=i.width()+parseInt(i.css("padding-left"),10)+parseInt(i.css("padding-right"),10)+6,r=i.height()+parseInt(i.css("padding-top"),10)+parseInt(i.css("padding-bottom"),10)+6;1==highlight&&(c(f,o,d,n,r),f.clearRect(o,d,n,r),dtype="highlight"),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),0==highlight&&(dtype="blackout",f.fillStyle="rgba(0,0,0,0.5)",f.fillRect(o,d,n,r)),t(".feedback-helper").each(function(){"blackout"==t(this).attr("data-type")&&(f.fillStyle="rgba(0,0,0,1)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()))}),"click"==a.type&&a.pageX==rect.startX&&a.pageY==rect.startY&&(t("#feedback-helpers").append('<div class="feedback-helper" data-highlight-id="'+u+'" data-type="'+dtype+'" data-time="'+Date.now()+'" style="position:absolute;top:'+d+"px;left:"+o+"px;width:"+n+"px;height:"+r+'px;z-index:30000;"></div>'),b.push(u),++u,s(f))}}})}t(document).on("mouseleave","body,#feedback-canvas",function(){s(f)}),t(document).on("mouseenter",".feedback-helper",function(){s(f)}),t(document).on("click","#feedback-welcome-next",function(){t("#feedback-note").val().length>0?(e=!0,t("#feedback-canvas").css("cursor","crosshair"),t("#feedback-helpers").show(),t("#feedback-welcome").hide(),t("#feedback-highlighter").show()):t("#feedback-welcome-error").show()}),t(document).on("mouseenter mouseleave",".feedback-helper",function(e){drag||(rect.w=0,rect.h=0,"mouseenter"===e.type?(t(this).css("z-index","30001"),t(this).append('<div class="feedback-helper-inner" style="width:'+(t(this).width()-2)+"px;height:"+(t(this).height()-2)+'px;position:absolute;margin:1px;"></div>'),t(this).append('<div id="feedback-close"></div>'),t(this).find("#feedback-close").css({top:-1*(t(this).find("#feedback-close").height()/2)+"px",left:t(this).width()-t(this).find("#feedback-close").width()/2+"px"}),"blackout"==t(this).attr("data-type")&&(f.clearRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),f.fillStyle="rgba(102,102,102,0.5)",f.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&c(f,parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()),f.fillStyle="rgba(0,0,0,0.75)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()),ignore=t(this).attr("data-time"),t(".feedback-helper").each(function(){return t(this).attr("data-time")==ignore?!0:void("blackout"==t(this).attr("data-type")&&(f.fillStyle="rgba(0,0,0,1)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())))}))):(t(this).css("z-index","30000"),t(this).children().remove(),"blackout"==t(this).attr("data-type")&&s(f)))}),t(document).on("click","#feedback-close",function(){if(o.highlightElement&&t(this).parent().attr("data-highlight-id"))var e=t(this).parent().attr("data-highlight-id");t(this).parent().remove(),o.highlightElement&&e&&t('[data-highlight-id="'+e+'"]').removeAttr("data-highlighted").removeAttr("data-highlight-id"),s(f)}),t("#feedback-module").on("click",".feedback-wizard-close,.feedback-close-btn",function(){i()}),t(document).on("keyup",function(e){27==e.keyCode&&i()}),t(document).on("selectstart dragstart",document,function(e){e.preventDefault()}),t(document).on("click","#feedback-highlighter-back",function(){e=!1,t("#feedback-canvas").css("cursor","default"),t("#feedback-helpers").hide(),t("#feedback-highlighter").hide(),t("#feedback-welcome-error").hide(),t("#feedback-welcome").show()}),t(document).on("mousedown",".feedback-sethighlight",function(){highlight=1,t(this).addClass("feedback-active"),t(".feedback-setblackout").removeClass("feedback-active")}),t(document).on("mousedown",".feedback-setblackout",function(){highlight=0,t(this).addClass("feedback-active"),t(".feedback-sethighlight").removeClass("feedback-active")}),t(document).on("click","#feedback-highlighter-next",function(){e=!1,t("#feedback-canvas").css("cursor","default");var c=t(document).scrollTop(),d=t(window).height();t("#feedback-helpers").hide(),t("#feedback-highlighter").hide(),o.screenshotStroke||s(f,!1),html2canvas(t("body"),{onrendered:function(e){o.screenshotStroke||s(f),_canvas=t('<canvas id="feedback-canvas-tmp" width="'+h+'" height="'+d+'"/>').hide().appendTo("body"),_ctx=_canvas.get(0).getContext("2d"),_ctx.drawImage(e,0,c,h,d,0,0,h,d),a=_canvas.get(0).toDataURL(),t(document).scrollTop(c),post.img=a,o.onScreenshotTaken(post.img),o.showDescriptionModal?(t("#feedback-canvas-tmp").remove(),t("#feedback-overview").show(),t("#feedback-overview-description-text>textarea").remove(),t("#feedback-overview-screenshot>img").remove(),t('<textarea id="feedback-overview-note">'+t("#feedback-note").val()+"</textarea>").insertAfter("#feedback-overview-description-text h3:eq(0)"),t("#feedback-overview-screenshot").append('<img class="feedback-screenshot" src="'+a+'" />')):(t("#feedback-module").remove(),i(),_canvas.remove())},proxy:o.proxy,letterRendering:o.letterRendering})}),t(document).on("click","#feedback-overview-back",function(a){e=!0,t("#feedback-canvas").css("cursor","crosshair"),t("#feedback-overview").hide(),t("#feedback-helpers").show(),t("#feedback-highlighter").show(),t("#feedback-overview-error").hide()}),t(document).on("keyup","#feedback-note-tmp,#feedback-overview-note",function(e){var a;"feedback-note-tmp"===e.target.id?a=t("#feedback-note-tmp").val():(a=t("#feedback-overview-note").val(),t("#feedback-note-tmp").val(a)),t("#feedback-note").val(a)}),t(document).on("click","#feedback-submit",function(){if(e=!1,t("#feedback-note").val().length>0){t("#feedback-submit-success,#feedback-submit-error").remove(),t("#feedback-overview").hide(),post.img=a,post.note=t("#feedback-note").val();var i={feedback:JSON.stringify(post)};t.ajax({url:o.ajaxURL,dataType:"json",type:"POST",data:i,success:function(){t("#feedback-module").append(o.tpl.submitSuccess)},error:function(){t("#feedback-module").append(o.tpl.submitError)}})}else t("#feedback-overview-error").show()})}))}}(jQuery)},{"../templates/description.html":2,"../templates/highlighter.html":3,"../templates/overview.html":4,"../templates/submitError.html":5,"../templates/submitSuccess.html":6}],2:[function(e,t,a){t.exports='<div id=feedback-welcome><div class=feedback-logo>Feedback</div><p>Feedback lets you send us suggestions about our products. We welcome problem reports, feature ideas and general comments.</p><p>Start by writing a brief description:</p><textarea id=feedback-note-tmp></textarea><p>Next we\'ll let you identify areas of the page related to your description.</p><button id=feedback-welcome-next class="feedback-next-btn feedback-btn-gray">Next</button><div id=feedback-welcome-error>Please enter a description.</div><div class=feedback-wizard-close></div></div>'},{}],3:[function(e,t,a){t.exports='<div id=feedback-highlighter><div class=feedback-logo>Feedback</div><p>Click and drag on the page to help us better understand your feedback. You can move this dialog if it\'s in the way.</p><button class="feedback-sethighlight feedback-active"><div class=ico></div><span>Highlight</span></button><label>Highlight areas relevant to your feedback.</label><button class=feedback-setblackout><div class=ico></div><span>Black out</span></button><label class=lower>Black out any personal information.</label><div class=feedback-buttons><button id=feedback-highlighter-next class="feedback-next-btn feedback-btn-gray">Next</button> <button id=feedback-highlighter-back class="feedback-back-btn feedback-btn-gray">Back</button></div><div class=feedback-wizard-close></div></div>'},{}],4:[function(e,t,a){t.exports='<div id=feedback-overview><div class=feedback-logo>Feedback</div><div id=feedback-overview-description><div id=feedback-overview-description-text><h3>Description</h3><h3 class=feedback-additional>Additional info</h3><div id=feedback-additional-none><span>None</span></div><div id=feedback-browser-info><span>Browser Info</span></div><div id=feedback-page-info><span>Page Info</span></div><div id=feedback-page-structure><span>Page Structure</span></div></div></div><div id=feedback-overview-screenshot><h3>Screenshot</h3></div><div class=feedback-buttons><button id=feedback-submit class="feedback-submit-btn feedback-btn-blue">Submit</button> <button id=feedback-overview-back class="feedback-back-btn feedback-btn-gray">Back</button></div><div id=feedback-overview-error>Please enter a description.</div><div class=feedback-wizard-close></div></div>'},{}],5:[function(e,t,a){t.exports='<div id=feedback-submit-error><div class=feedback-logo>Feedback</div><p>Sadly an error occured while sending your feedback. Please try again.</p><button class="feedback-close-btn feedback-btn-blue">OK</button><div class=feedback-wizard-close></div></div>'},{}],6:[function(e,t,a){t.exports='<div id=feedback-submit-success><div class=feedback-logo>Feedback</div><p>Thank you for your feedback. We value every piece of feedback we receive.</p><p>We cannot respond individually to every one, but we will use your comments as we strive to improve your experience.</p><button class="feedback-close-btn feedback-btn-blue">OK</button><div class=feedback-wizard-close></div></div>'},{}]},{},[1]);
=======
!function e(t,a,i){function s(o,d){if(!a[o]){if(!t[o]){var n="function"==typeof require&&require;if(!d&&n)return n(o,!0);if(c)return c(o,!0);throw new Error("Cannot find module '"+o+"'")}var r=a[o]={exports:{}};t[o][0].call(r.exports,function(e){var a=t[o][1][e];return s(a?a:e)},r,r.exports,e,t,a,i)}return a[o].exports}for(var c="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,a){!function(t){t.feedback=function(a){function i(){canDraw=!1,t(document).off("mouseenter mouseleave",".feedback-helper"),t(document).off("mouseup keyup"),t(document).off("mousedown",".feedback-setblackout"),t(document).off("mousedown",".feedback-sethighlight"),t(document).off("mousedown click","#feedback-close"),t(document).off("mousedown","#feedback-canvas"),t(document).off("click","#feedback-highlighter-next"),t(document).off("click","#feedback-highlighter-back"),t(document).off("click","#feedback-welcome-next"),t(document).off("click","#feedback-overview-back"),t(document).off("mouseleave","body"),t(document).off("mouseenter",".feedback-helper"),t(document).off("selectstart dragstart",document),t("#feedback-module").off("click",".feedback-wizard-close,.feedback-close-btn"),t(document).off("click","#feedback-submit"),o.highlightElement&&(t(document).off("click","#feedback-canvas"),t(document).off("mousemove","#feedback-canvas")),t('[data-highlighted="true"]').removeAttr("data-highlight-id").removeAttr("data-highlighted"),t("#feedback-module").remove(),t(".feedback-btn").show(),o.onClose.call(this)}function s(e,a){a="undefined"!=typeof a?a:!0,e.clearRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),e.fillStyle="rgba(102,102,102,0.5)",e.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&a&&c(e,parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&e.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"blackout"==t(this).attr("data-type")&&(e.fillStyle="rgba(0,0,0,1)",e.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()))})}function c(e,t,a,i,s){e.strokeStyle=o.strokeStyle,e.shadowColor=o.shadowColor,e.shadowOffsetX=o.shadowOffsetX,e.shadowOffsetY=o.shadowOffsetY,e.shadowBlur=o.shadowBlur,e.lineJoin=o.lineJoin,e.lineWidth=o.lineWidth,e.strokeRect(t,a,i,s),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.lineWidth=1}var o=t.extend({ajaxURL:"",postBrowserInfo:!0,postHTML:!0,postURL:!0,proxy:void 0,letterRendering:!1,initButtonText:"Send feedback",strokeStyle:"black",shadowColor:"black",shadowOffsetX:1,shadowOffsetY:1,shadowBlur:10,lineJoin:"bevel",lineWidth:3,html2canvasURL:"html2canvas.js",feedbackButton:".feedback-btn",showDescriptionModal:!0,isDraggable:!0,onScreenshotTaken:function(){},tpl:{description:e("../templates/description.html"),highlighter:e("../templates/highlighter.html"),overview:e("../templates/overview.html"),submitSuccess:e("../templates/submitSuccess.html"),submitError:e("../templates/submitError.html")},onClose:function(){},screenshotStroke:!0,highlightElement:!0,initialBox:!1},a),d=!!window.HTMLCanvasElement,n=".feedback-btn"==o.feedbackButton,r=!1;d&&(n&&t("body").append('<button class="feedback-btn feedback-btn-gray">'+o.initButtonText+"</button>"),t(document).on("click",o.feedbackButton,function(){n&&t(this).hide(),r||t.getScript(o.html2canvasURL,function(){r=!0});var e=!1,a="",d=t(document).height(),h=t(document).width(),l='<div id="feedback-module">';o.initialBox&&(l+=o.tpl.description),l+=o.tpl.highlighter+o.tpl.overview+'<canvas id="feedback-canvas"></canvas><div id="feedback-helpers"></div><input id="feedback-note" name="feedback-note" type="hidden"></div>',t("body").append(l),moduleStyle={position:"absolute",left:"0px",top:"0px"},canvasAttr={width:h,height:d},t("#feedback-module").css(moduleStyle),t("#feedback-canvas").attr(canvasAttr).css("z-index","30000"),o.initialBox||(t("#feedback-highlighter-back").remove(),e=!0,t("#feedback-canvas").css("cursor","crosshair"),t("#feedback-helpers").show(),t("#feedback-welcome").hide(),t("#feedback-highlighter").show()),o.isDraggable&&t("#feedback-highlighter").on("mousedown",function(e){var a=t(this).addClass("feedback-draggable"),i=a.outerHeight(),s=a.outerWidth(),c=a.offset().top+i-e.pageY,o=a.offset().left+s-e.pageX;a.css("z-index",4e4).parents().on("mousemove",function(e){_top=e.pageY+c-i,_left=e.pageX+o-s,_bottom=i-e.pageY,_right=s-e.pageX,_left<0&&(_left=0),_top<0&&(_top=0),_right>t(window).width()&&(_left=t(window).width()-s),_left>t(window).width()-s&&(_left=t(window).width()-s),_bottom>t(document).height()&&(_top=t(document).height()-i),_top>t(document).height()-i&&(_top=t(document).height()-i),t(".feedback-draggable").offset({top:_top,left:_left}).on("mouseup",function(){t(this).removeClass("feedback-draggable")})}),e.preventDefault()}).on("mouseup",function(){t(this).removeClass("feedback-draggable"),t(this).parents().off("mousemove mousedown")});var f=t("#feedback-canvas")[0].getContext("2d");if(f.fillStyle="rgba(102,102,102,0.5)",f.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),rect={},drag=!1,highlight=1,post={},o.postBrowserInfo&&(post.browser={},post.browser.appCodeName=navigator.appCodeName,post.browser.appName=navigator.appName,post.browser.appVersion=navigator.appVersion,post.browser.cookieEnabled=navigator.cookieEnabled,post.browser.onLine=navigator.onLine,post.browser.platform=navigator.platform,post.browser.userAgent=navigator.userAgent,post.browser.plugins=[],t.each(navigator.plugins,function(e){post.browser.plugins.push(navigator.plugins[e].name)}),t("#feedback-browser-info").show()),o.postURL&&(post.url=document.URL,t("#feedback-page-info").show()),o.postHTML&&(post.html=t("html").html(),t("#feedback-page-structure").show()),o.postBrowserInfo||o.postURL||o.postHTML||t("#feedback-additional-none").show(),t(document).on("mousedown","#feedback-canvas",function(a){e&&(rect.startX=a.pageX-t(this).offset().left,rect.startY=a.pageY-t(this).offset().top,rect.w=0,rect.h=0,drag=!0)}),t(document).on("mouseup",function(){if(e){drag=!1;var a=rect.startY,i=rect.startX,c=rect.w,o=rect.h;if(dtype="highlight",0==c||0==o)return;0>c&&(i+=c,c*=-1),0>o&&(a+=o,o*=-1),a+o>t(document).height()&&(o=t(document).height()-a),i+c>t(document).width()&&(c=t(document).width()-i),0==highlight&&(dtype="blackout"),t("#feedback-helpers").append('<div class="feedback-helper" data-type="'+dtype+'" data-time="'+Date.now()+'" style="position:absolute;top:'+a+"px;left:"+i+"px;width:"+c+"px;height:"+o+'px;z-index:30000;"></div>'),s(f),rect.w=0}}),t(document).on("mousemove",function(a){e&&drag&&(t("#feedback-highlighter").css("cursor","default"),rect.w=a.pageX-t("#feedback-canvas").offset().left-rect.startX,rect.h=a.pageY-t("#feedback-canvas").offset().top-rect.startY,f.clearRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),f.fillStyle="rgba(102,102,102,0.5)",f.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&c(f,parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),1==highlight&&(c(f,rect.startX,rect.startY,rect.w,rect.h),f.clearRect(rect.startX,rect.startY,rect.w,rect.h)),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"blackout"==t(this).attr("data-type")&&(f.fillStyle="rgba(0,0,0,1)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()))}),0==highlight&&(f.fillStyle="rgba(0,0,0,0.5)",f.fillRect(rect.startX,rect.startY,rect.w,rect.h)))}),o.highlightElement){var b=[],p=[],u=0;t(document).on("mousemove click","#feedback-canvas",function(a){if(e){s(f),p=[],t("#feedback-canvas").css("cursor","crosshair"),t("* :not(body,script,iframe,div,section,.feedback-btn,#feedback-module *)").each(function(){"true"!==t(this).attr("data-highlighted")&&a.pageX>t(this).offset().left&&a.pageX<t(this).offset().left+t(this).width()&&a.pageY>t(this).offset().top+parseInt(t(this).css("padding-top"),10)&&a.pageY<t(this).offset().top+t(this).height()+parseInt(t(this).css("padding-top"),10)&&p.push(t(this))});var i=p[p.length-1];if(i&&!drag){t("#feedback-canvas").css("cursor","pointer");var o=i.offset().left-2,d=i.offset().top-2,n=i.width()+parseInt(i.css("padding-left"),10)+parseInt(i.css("padding-right"),10)+6,r=i.height()+parseInt(i.css("padding-top"),10)+parseInt(i.css("padding-bottom"),10)+6;1==highlight&&(c(f,o,d,n,r),f.clearRect(o,d,n,r),dtype="highlight"),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),0==highlight&&(dtype="blackout",f.fillStyle="rgba(0,0,0,0.5)",f.fillRect(o,d,n,r)),t(".feedback-helper").each(function(){"blackout"==t(this).attr("data-type")&&(f.fillStyle="rgba(0,0,0,1)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()))}),"click"==a.type&&Math.round(a.pageX)==Math.round(rect.startX)&&Math.round(a.pageY)==Math.round(rect.startY)&&(t("#feedback-helpers").append('<div class="feedback-helper" data-highlight-id="'+u+'" data-type="'+dtype+'" data-time="'+Date.now()+'" style="position:absolute;top:'+d+"px;left:"+o+"px;width:"+n+"px;height:"+r+'px;z-index:30000;"></div>'),b.push(u),++u,s(f))}}})}t(document).on("mouseleave","body,#feedback-canvas",function(){s(f)}),t(document).on("mouseenter",".feedback-helper",function(){s(f)}),t(document).on("click","#feedback-welcome-next",function(){t("#feedback-note").val().length>0?(e=!0,t("#feedback-canvas").css("cursor","crosshair"),t("#feedback-helpers").show(),t("#feedback-welcome").hide(),t("#feedback-highlighter").show()):t("#feedback-welcome-error").show()}),t(document).on("mouseenter mouseleave",".feedback-helper",function(e){drag||(rect.w=0,rect.h=0,"mouseenter"===e.type?(t(this).css("z-index","30001"),t(this).append('<div class="feedback-helper-inner" style="width:'+(t(this).width()-2)+"px;height:"+(t(this).height()-2)+'px;position:absolute;margin:1px;"></div>'),t(this).append('<div id="feedback-close"></div>'),t(this).find("#feedback-close").css({top:-1*(t(this).find("#feedback-close").height()/2)+"px",left:t(this).width()-t(this).find("#feedback-close").width()/2+"px"}),"blackout"==t(this).attr("data-type")&&(f.clearRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),f.fillStyle="rgba(102,102,102,0.5)",f.fillRect(0,0,t("#feedback-canvas").width(),t("#feedback-canvas").height()),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&c(f,parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),t(".feedback-helper").each(function(){"highlight"==t(this).attr("data-type")&&f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())}),f.clearRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()),f.fillStyle="rgba(0,0,0,0.75)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height()),ignore=t(this).attr("data-time"),t(".feedback-helper").each(function(){return t(this).attr("data-time")==ignore?!0:void("blackout"==t(this).attr("data-type")&&(f.fillStyle="rgba(0,0,0,1)",f.fillRect(parseInt(t(this).css("left"),10),parseInt(t(this).css("top"),10),t(this).width(),t(this).height())))}))):(t(this).css("z-index","30000"),t(this).children().remove(),"blackout"==t(this).attr("data-type")&&s(f)))}),t(document).on("click","#feedback-close",function(){if(o.highlightElement&&t(this).parent().attr("data-highlight-id"))var e=t(this).parent().attr("data-highlight-id");t(this).parent().remove(),o.highlightElement&&e&&t('[data-highlight-id="'+e+'"]').removeAttr("data-highlighted").removeAttr("data-highlight-id"),s(f)}),t("#feedback-module").on("click",".feedback-wizard-close,.feedback-close-btn",function(){i()}),t(document).on("keyup",function(e){27==e.keyCode&&i()}),t(document).on("selectstart dragstart",document,function(e){e.preventDefault()}),t(document).on("click","#feedback-highlighter-back",function(){e=!1,t("#feedback-canvas").css("cursor","default"),t("#feedback-helpers").hide(),t("#feedback-highlighter").hide(),t("#feedback-welcome-error").hide(),t("#feedback-welcome").show()}),t(document).on("mousedown",".feedback-sethighlight",function(){highlight=1,t(this).addClass("feedback-active"),t(".feedback-setblackout").removeClass("feedback-active")}),t(document).on("mousedown",".feedback-setblackout",function(){highlight=0,t(this).addClass("feedback-active"),t(".feedback-sethighlight").removeClass("feedback-active")}),t(document).on("click","#feedback-highlighter-next",function(){e=!1,t("#feedback-canvas").css("cursor","default");var c=t(document).scrollTop(),d=t(window).height();t("#feedback-helpers").hide(),t("#feedback-highlighter").hide(),o.screenshotStroke||s(f,!1),html2canvas(t("body"),{onrendered:function(e){o.screenshotStroke||s(f),_canvas=t('<canvas id="feedback-canvas-tmp" width="'+h+'" height="'+d+'"/>').hide().appendTo("body"),_ctx=_canvas.get(0).getContext("2d"),_ctx.drawImage(e,0,c,h,d,0,0,h,d),a=_canvas.get(0).toDataURL(),t(document).scrollTop(c),post.img=a,o.onScreenshotTaken(post.img),o.showDescriptionModal?(t("#feedback-canvas-tmp").remove(),t("#feedback-overview").show(),t("#feedback-overview-description-text>textarea").remove(),t("#feedback-overview-screenshot>img").remove(),t('<textarea id="feedback-overview-note">'+t("#feedback-note").val()+"</textarea>").insertAfter("#feedback-overview-description-text h3:eq(0)"),t("#feedback-overview-screenshot").append('<img class="feedback-screenshot" src="'+a+'" />')):(t("#feedback-module").remove(),i(),_canvas.remove())},proxy:o.proxy,letterRendering:o.letterRendering})}),t(document).on("click","#feedback-overview-back",function(a){e=!0,t("#feedback-canvas").css("cursor","crosshair"),t("#feedback-overview").hide(),t("#feedback-helpers").show(),t("#feedback-highlighter").show(),t("#feedback-overview-error").hide()}),t(document).on("keyup","#feedback-note-tmp,#feedback-overview-note",function(e){var a;"feedback-note-tmp"===e.target.id?a=t("#feedback-note-tmp").val():(a=t("#feedback-overview-note").val(),t("#feedback-note-tmp").val(a)),t("#feedback-note").val(a)}),t(document).on("click","#feedback-submit",function(){if(e=!1,t("#feedback-note").val().length>0){t("#feedback-submit-success,#feedback-submit-error").remove(),t("#feedback-overview").hide(),post.img=a,post.note=t("#feedback-note").val();var i={feedback:JSON.stringify(post)};t.ajax({url:o.ajaxURL,dataType:"json",type:"POST",data:i,success:function(){t("#feedback-module").append(o.tpl.submitSuccess)},error:function(){t("#feedback-module").append(o.tpl.submitError)}})}else t("#feedback-overview-error").show()})}))}}(jQuery)},{"../templates/description.html":2,"../templates/highlighter.html":3,"../templates/overview.html":4,"../templates/submitError.html":5,"../templates/submitSuccess.html":6}],2:[function(e,t,a){t.exports='<div id=feedback-welcome><div class=feedback-logo>Feedback</div><p>Feedback lets you send us suggestions about our products. We welcome problem reports, feature ideas and general comments.</p><p>Start by writing a brief description:</p><textarea id=feedback-note-tmp></textarea><p>Next we\'ll let you identify areas of the page related to your description.</p><button id=feedback-welcome-next class="feedback-next-btn feedback-btn-gray">Next</button><div id=feedback-welcome-error>Please enter a description.</div><div class=feedback-wizard-close></div></div>'},{}],3:[function(e,t,a){t.exports='<div id=feedback-highlighter><div class=feedback-logo>Feedback</div><p>Click and drag on the page to help us better understand your feedback. You can move this dialog if it\'s in the way.</p><button class="feedback-sethighlight feedback-active"><div class=ico></div><span>Highlight</span></button><label>Highlight areas relevant to your feedback.</label><button class=feedback-setblackout><div class=ico></div><span>Black out</span></button><label class=lower>Black out any personal information.</label><div class=feedback-buttons><button id=feedback-highlighter-next class="feedback-next-btn feedback-btn-gray">Next</button> <button id=feedback-highlighter-back class="feedback-back-btn feedback-btn-gray">Back</button></div><div class=feedback-wizard-close></div></div>'},{}],4:[function(e,t,a){t.exports='<div id=feedback-overview><div class=feedback-logo>Feedback</div><div id=feedback-overview-description><div id=feedback-overview-description-text><h3>Description</h3><h3 class=feedback-additional>Additional info</h3><div id=feedback-additional-none><span>None</span></div><div id=feedback-browser-info><span>Browser Info</span></div><div id=feedback-page-info><span>Page Info</span></div><div id=feedback-page-structure><span>Page Structure</span></div></div></div><div id=feedback-overview-screenshot><h3>Screenshot</h3></div><div class=feedback-buttons><button id=feedback-submit class="feedback-submit-btn feedback-btn-blue">Submit</button> <button id=feedback-overview-back class="feedback-back-btn feedback-btn-gray">Back</button></div><div id=feedback-overview-error>Please enter a description.</div><div class=feedback-wizard-close></div></div>'},{}],5:[function(e,t,a){t.exports='<div id=feedback-submit-error><div class=feedback-logo>Feedback</div><p>Sadly an error occured while sending your feedback. Please try again.</p><button class="feedback-close-btn feedback-btn-blue">OK</button><div class=feedback-wizard-close></div></div>'},{}],6:[function(e,t,a){t.exports='<div id=feedback-submit-success><div class=feedback-logo>Feedback</div><p>Thank you for your feedback. We value every piece of feedback we receive.</p><p>We cannot respond individually to every one, but we will use your comments as we strive to improve your experience.</p><button class="feedback-close-btn feedback-btn-blue">OK</button><div class=feedback-wizard-close></div></div>'},{}]},{},[1]);
>>>>>>> 0799928... Click not adding a feedback rectangle
